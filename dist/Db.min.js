Db={Database:function(o,e){var u;if("object"==typeof o&&"getSpreadsheetTimeZone"in o)o=o;else if("object"==typeof o&&"showSheet"in o)o=o.getParent();else if("object"==typeof o&&"getMimeType"in o&&MimeType.GOOGLE_SHEETS==o.getMimeType())try{o=SpreadsheetApp.open(o)}catch(e){}else if("string"==typeof o&&o.startsWith("https://"))try{o=SpreadsheetApp.openByUrl(o)}catch(e){}else if("string"==typeof o&&Fs.File.Exists(o))try{o=SpreadsheetApp.open(Fs.File.Get(o))}catch(e){}else try{o=SpreadsheetApp.openById(o)}catch(e){}return Object.defineProperty(this,"SS",{configurable:!1,enumerable:!1,get:function(){return o}}),Object.defineProperty(this,"AddTable",{configurable:!1,enumerable:!1,value:function(e,t){var n,r,i=o.insertSheet(e);r=t,(n=i).getRange(1,1,1,r.length).setValues([r]).setBackground("#b7b7b7").setFontSize(12).setFontWeight("bold").setFontLine("underline").setHorizontalAlignment("center"),n.deleteColumns(r.length+1,n.getMaxColumns()-r.length),n.setFrozenRows(1);var a=new Db.Table(i);return u[a.Name]=a}}),Object.defineProperty(this,"Copy",{configurable:!1,enumerable:!1,value:function(e){return o.copy(e)}}),Object.defineProperty(this,"Name",{configurable:!1,enumerable:!1,get:function(){return o.getName()},set:function(e){return o.rename(e),this}}),Object.defineProperty(this,"Tables",{configurable:!1,enumerable:!1,get:function(){return void 0===u&&(u=[],o.getSheets().forEach(function(e){var t=new Db.Table(e);u[t.Name]=t})),u}}),void 0!==e&&this.Tables,this},Table:function(a){var o;return Object.defineProperty(this,"Add",{configurable:!1,enumerable:!1,value:function(e){if("object"!=typeof e)return!1;e=e.IsArray()?e:this.Convert(e);var t=this.Exists(o[0],e[0]);return 0<t?this.Row(t).Update(e):a.appendRow(e),!0}}),Object.defineProperty(this,"Convert",{configurable:!1,enumerable:!1,value:function(n){if("object"!=typeof n)return n;if(n.IsArray()){var r={};return o.forEach(function(e,t){r[e]=n[t]}),r}var i=[];return o.forEach(function(e,t){i.push(n[e])}),i}}),Object.defineProperty(this,"Data",{configurable:!1,enumerable:!0,get:function(){var e=a.getDataRange().getValues().slice(1),n=this;return Object.defineProperty(e,"AsObjects",{configurable:!1,enumerable:!1,get:function(){var t=[];return e.forEach(function(e){t.push(n.Convert(e))}),t}}),e}}),Object.defineProperty(this,"Delete",{configurable:!1,enumerable:!1,value:function(e,t){var n=this.Exists(e,t);return 0<n&&(this.Row(n).Delete(),!0)}}),Object.defineProperty(this,"Exists",{configurable:!1,enumerable:!0,value:function(e,t){if(!o.Contains(e))return-1;for(var n=this.FieldIndex(e),r=a.getDataRange().getValues(),i=1;i<r.length;i++)if(t==r[i][n])return i+1;return 0}}),Object.defineProperty(this,"Export",{configurable:!1,enumerable:!1,value:function(e){void 0===e&&(e={});var t="AsObjects"in e?this.Data.AsObjects:this.Data,n="PrettyPrint"in e?JSON.stringify({fields:o,data:t},null,4):JSON.stringify({fields:o,data:t});return"FolderId"in e&&DriveApp.getFolderById(e.FolderId).createFile(a.getParent().getName()+"."+a.getName()+"."+Date.now()+".json",n),n}}),Object.defineProperty(this,"FieldIndex",{configurable:!1,enumerable:!0,value:function(e){for(var t=0;t<o.length;t++)if(e==o[t])return t;return-1}}),Object.defineProperty(this,"Fields",{configurable:!1,enumerable:!0,get:function(){return void 0===o&&(o=0==a.getLastRow()||0==a.getLastColumn()?[]:a.getRange(1,1,1,a.getLastColumn()).getValues()[0]),o}}),Object.defineProperty(this,"Get",{configurable:!1,enumerable:!1,value:function(e,t){var n=this.Exists(e,t);if(!(n<1)){var r=this,i=this.Row(n).Values[0];return Object.defineProperty(i,"AsObject",{configurable:!1,enumerable:!1,get:function(){return r.Convert(this)}}),i}}}),Object.defineProperty(this,"Name",{configurable:!1,enumerable:!0,get:function(){return a.getName()}}),Object.defineProperty(this,"Row",{configurable:!1,enumerable:!1,value:function(e){return new Db.Row(this,a.getRange(e,1,1,o.length))}}),Object.defineProperty(this,"Sheet",{configurable:!1,enumerable:!1,get:function(){return a}}),Object.defineProperty(this,"Sort",{configurable:!1,enumerable:!0,value:function(e,t){"string"==typeof e&&(e=this.FieldIndex(e)+1),"number"!=typeof e&&(e=0),t=void 0!==t&&!1!==t&&0!==t,a.getRange(2,1,a.getLastRow()-1,a.getLastColumn()).sort({column:e,ascending:!t})}}),Object.defineProperty(this,"Update",{configurable:!1,enumerable:!0,value:function(e){e.IsArray()||(e=this.Convert(e));var t=this.Exists(o[0],e.IsArray()?e[0]:e[o[0]]);if(!(t<1))return this.Row(t).Update(e.IsArray()?e:this.Convert(e))}}),this},Row:function(t,n){return Object.defineProperties(this,{Delete:{configurable:!1,enumerable:!1,value:function(){t.Sheet.deleteRow(n.getRow())}},Get:{configurable:!1,enumerable:!1,value:function(e){return void 0===e?n.getValues():"number"==typeof e?n.getValues()[e]:"string"==typeof e?n.getValues()[t.FieldIndex(e)]:null}},Update:{configurable:!1,enumerable:!1,value:function(e){return n.setValues([e]),!0}},Values:{configurable:!1,enumerable:!1,get:function(){return n.getValues()}}}),this}};